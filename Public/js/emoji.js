function g_emoji(left){
	var str = '<div class="fr-popup comment-emoji" style="left:'+left+'px"><div style="text-align: center"><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f600"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f600.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f601"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f601.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f602"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f602.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f603"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f603.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f604"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f604.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="笑脸张开嘴，一身冷汗" data-param1="1f605"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f605.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="笑脸张开嘴，紧紧闭着眼睛" data-param1="1f606"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f606.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="笑脸晕" data-param1="1f607"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f607.svg"></span><br><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="微笑的脸角" data-param1="1f608"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f608.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="眨眼表情" data-param1="1f609"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f609.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="面带微笑的眼睛" data-param1="1f60a"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f60a.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f60b"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f60b.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f60c"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f60c.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f60d"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f60d.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f60e"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f60e.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="面对面带笑容" data-param1="1f60f"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f60f.svg"></span><br><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="中性面" data-param1="1f610"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f610.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="面无表情" data-param1="1f611"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f611.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="一脸不快的脸" data-param1="1f612"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f612.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f613"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f613.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f614"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f614.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f615"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f615.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="该死的脸" data-param1="1f616"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f616.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f617"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f617.svg"></span><br><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="面对投掷一个吻" data-param1="1f618"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f618.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="接吻脸，含笑的眼睛" data-param1="1f619"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f619.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="接吻的脸闭着眼睛" data-param1="1f61a"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f61a.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f61b"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f61b.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f61c"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f61c.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f61d"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f61d.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="面对失望" data-param1="1f61e"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f61e.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f61f"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f61f.svg"></span><br><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="愤怒的脸" data-param1="1f620"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f620.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="面对噘嘴" data-param1="1f621"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f621.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="哭泣的脸" data-param1="1f622"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f622.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f623"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f623.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f624"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f624.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f625"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f625.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f626"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f626.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f627"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f627.svg"></span><br><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f628"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f628.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="面对厌倦" data-param1="1f629"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f629.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="面对困" data-param1="1f62a"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f62a.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="疲惫的脸" data-param1="1f62b"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f62b.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f62c"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f62c.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f62d"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f62d.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f62e"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f62e.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f62f"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f62f.svg"></span><br><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="Face with open mouth and cold sweat" data-param1="1f630"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f630.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="面对张开嘴，一身冷汗" data-param1="1f631"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f631.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="面对惊讶" data-param1="1f632"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f632.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="红扑扑的脸蛋" data-param1="1f633"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f633.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f634"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f634.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f635"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f635.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" data-param1="1f636"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f636.svg"></span><span class="fr-command fr-emoticon emoji-item" data-cmd="insertEmoticon" title="面对医疗口罩" data-param1="1f637"><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.0.1/assets/svg/1f637.svg"></span></div></div>';
	return str;
}
function emoji_click(_self,left){
	var _emoji_out_container = _self.parents('.comment-op')
	var _emoji_length =_emoji_out_container.find('.fr-popup.comment-emoji').length;
	if(_emoji_length==0){
		var str = g_emoji(left);
		_emoji_out_container.append(str);
	}
	if(_self.hasClass('active')){
		_self.removeClass('active');
		var _input = _emoji_out_container.siblings('.to_input');
		var length_text = _input.val();
		_input.focus().setpos(length_text.length);
	}else{
		_self.addClass('active');
	}
	
	_emoji_out_container.find('.fr-popup.comment-emoji').fadeToggle('fast');
}
$(document).on('click','.emoji-item',function(e){
    e.stopPropagation();
	var _self = $(this);
	var _emoji_code = "[:"+_self.attr('data-param1')+":]";
	var _emoji_length = _emoji_code.length;
	var _input = _self.parents('.comment-emoji').parents('.comment-op').siblings('.form-control.to_input');
	var _cursor_position = _input.getpos();
	_input.insertforpos(_emoji_code);
	// _input.setpos(_cursor_position+_emoji_length);
})
$(document).click(function(e) {
	$('.emoji-index,.emoji').removeClass('active');
	$('.fr-popup.comment-emoji').hide();
});
$(function(){
	
	$('.emoji-index').click(function(e){
		e.stopPropagation();
		var _self = $(this);
		emoji_click(_self,0);
	})
	$('.emoji').click(function(e) {
		e.stopPropagation();
		var _self = $(this);
		emoji_click(_self,-60);
    });
})